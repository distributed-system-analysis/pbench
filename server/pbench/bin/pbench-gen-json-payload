#!/usr/bin/env python

import sys
import json

with open(sys.argv[4], "r") as fp:
    text = fp.read()

doc = {
    "@timestamp": sys.argv[1],
    "name": sys.argv[2],
    "doctype": sys.argv[3],
    "text": text
}

try:
    pretty_arg = sys.argv[5]
except Exception:
    pretty = True
else:
    pretty = True if pretty_arg == "true" else False

if pretty:
    json.dump(doc, sys.stdout, sort_keys=True, indent=4, separators=(',', ': '))
    sys.stdout.write('\n')
else:
    json.dump(doc, sys.stdout, sort_keys=True)

sys.exit(0)
