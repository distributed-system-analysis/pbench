#!/usr/bin/env python2

import os
import sys
import shutil

if len(sys.argv) < 2:
    print "Missing working directory argument"
    sys.exit(1)

if len(sys.argv) > 2:
    print "Too many arguments (%r)" % sys.argv
    sys.exit(1)

try:
    os.chdir(sys.argv[1])
except Exception as e:
    print (e)
    sys.exit(1)

errors = 0
for tar in sys.stdin:
    try:
        src = tar.strip('\n')
        des = src.replace("TO-SYNC", "TO-DELETE")
        shutil.move(src, des)
    except Exception as e:
        errors += 1
        print (e)
        continue

sys.exit(1 if errors > 0 else 0)
